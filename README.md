🚒 電動車安全救援訓練統計系統 (EV Training Statistics System)
這是一套基於 Web (HTML/JS) 與 Google Apps Script (GAS) 開發的輕量級訓練管理系統。旨在協助訓練中心管理電動車相關的訓練場次、人數統計，並支援雲端同步與報表輸出。
✨ 核心功能
☁️ 雲端同步：資料自動寫入 Google Sheets，無需架設伺服器。
📅 智慧日曆：
支援多選日期、排除六日、全選當月。
自動將日期轉換為公務格式（如：114年1月1、3、5日）。
📂 CSV 匯入：支援從舊系統或 Excel 快速匯入大量資料。
📊 報表輸出：
陳報版：精簡欄位，適合列印或呈報。
完整版：包含所有欄位，適合備份。
📱 響應式設計：支援電腦與手機操作 (Tailwind CSS)。
🛠️ 系統架構
前端：單一 HTML 檔案 (index.html)。
使用套件：Tailwind CSS (樣式), ExcelJS (匯出), PapaParse (CSV解析), RemixIcon (圖示)。
後端：Google Apps Script (Code.gs)。
負責處理 POST (儲存) 與 GET (讀取) 請求。
處理併發鎖定 (LockService) 防止資料衝突。
資料庫：Google Sheets (試算表)。
🚀 部署與安裝教學
1. 後端 (Google Apps Script)
建立一個新的 Google Sheet，命名為 電動車訓練統計資料庫。
點擊選單 擴充功能 > Apps Script。
將後端程式碼 (Code.gs) 貼入編輯器。
執行 setupSheet 函式以初始化工作表（建立標題列）。
部署：
點擊右上角 「部署」 > 「新增部署作業」。
類型選 「網頁應用程式」。
執行身分：「我 (Me)」。
誰可以存取：「任何人 (Anyone)」 (⚠️ 重要！)。
複製產生的 Web App URL。
2. 前端 (HTML)
開啟 index.html。
找到第 16 行左右的設定區：
code
JavaScript
const GAS_API_URL = "您的_GAS_WEB_APP_URL";
將剛剛複製的網址貼上並存檔。
直接用瀏覽器開啟 index.html 即可使用。
📖 使用說明
A. 新增資料 (新增作業區)
手動輸入：點擊「新增一列」，填寫訓練資訊。
日期選擇：點擊日期欄位旁的小圖示，開啟「智慧日曆」進行多選。
匯入 CSV：點擊「匯入 CSV」可批次載入資料（可先下載範本）。
儲存：確認無誤後，點擊 「儲存至雲端」，資料將寫入 Google Sheet。
B. 查詢與匯出 (歷史資料庫)
切換至「歷史資料庫」頁籤。
系統會自動載入雲端資料，並依日期 由新到舊 排序。
下載報表：點擊綠色按鈕，選擇「陳報上級版」或「完整資料庫」匯出 .xlsx 檔。
C. 舊資料遷移
若有歷史資料 CSV 檔：
在「新增作業區」點擊 匯入 CSV。
確認資料載入表格後，點擊 儲存至雲端。
系統會自動將舊資料批次寫入後端。
⚠️ 注意事項與維護
日期格式：系統依賴 114年X月X日 的格式進行排序，手動修改 Google Sheet 時請保持格式一致。
權限設定：若出現「存取被拒」或無法儲存，請檢查 GAS 部署設定是否為「任何人 (Anyone)」。
修改程式碼：若修改了 GAS 後端程式碼，務必執行 「部署」>「管理部署作業」>「建立新版本」，更新才會生效。
📂 資料欄位對照 (Google Sheet)
欄位 (Col)	名稱	說明
A	日期	訓練舉辦日期
B	單位/層級	主辦單位
C	地點	訓練地點
D	訓練項目	課程名稱
E	辦理場次	數字
F	參與人數	數字
G	備註	其他說明
H	建立時間	系統自動寫入
